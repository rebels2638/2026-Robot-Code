---
description: WPILib Agent Tools core sandbox workflow
alwaysApply: true
---

# WPILib Agent Tools Core Rule

## Sandbox workflow

- Use sandboxes for iterative testing and simulation runs â€” not required for simple, non-iterative changes.
- When using a sandbox:
  1. `wpilib-agent-tools sandbox create --name <id> --source workspace`
  2. Execute commands via `wpilib-agent-tools sandbox run --name <id> -- <command>`
  3. Generate a patch with `wpilib-agent-tools sandbox patch --name <id> --output <file>`
  4. Apply reviewed patch to workspace only after explicit approval.
  5. Clean up with `wpilib-agent-tools sandbox clean --name <id>` unless the user asks to keep it.

## Execution safety

- Use `wpilib-agent-tools sandbox status` and `sandbox stop --name <id>` to manage your own sandbox jobs.
- Prefer bounded runs and machine-consumable output (`--json`) whenever possible.

## Robot mode alignment

- Before running simulation, identify the current mode/switching pattern (simulation vs IRL, etc.).
- Check `Constants.java` first, then other mode-routing code (mode enums, `RobotContainer` wiring, build flags) to ensure the correct mode is active for simulation and change if needed.
- When simulation should start in autonomous mode, set this in `robotInit()`:
  ```java
  DriverStationSim.setAutonomous(true);
  DriverStationSim.setEnabled(true);
  DriverStationSim.notifyNewData();
  ```
- Change if needed.

## CLI reference

- Run `wpilib-agent-tools --help` or `wpilib-agent-tools <command> --help` for full command and option details.